package nl.rijksoverheid.mev.privateapi.gezagsmodule;

import nl.rijksoverheid.mev.exception.AfleidingsregelException;
import nl.rijksoverheid.mev.privateapi.gezagsmodule.util.CsvTestResultWriter;
import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.Arguments;
import org.junit.jupiter.params.provider.MethodSource;
import org.springframework.test.context.TestPropertySource;

import java.io.IOException;
import java.util.List;
import java.util.stream.Stream;

@TestPropertySource(properties = "app.features.brp.dataset-path=src/test/resources/fixtures/persoonslijsten/GegenereerdUitExcelData/CGR_testbestand-20220825_reversed_onder_pilot_autorisatiebesluit")
public class GezagsmoduleCgrReversedTest extends GezagsmoduleTest {

    @BeforeAll
    public static void initialize() throws IOException {
        CsvTestResultWriter.setup("CgrReversedTestOutput.csv");
    }

    private static Stream<Arguments> testArguments() {
        return Stream.of(
                Arguments.of("Lg01_001R", "999998778", List.of(), "2m"),
                Arguments.of("Lg01_002R", "999998791", List.of(), "2m"),
                Arguments.of("Lg01_003R", "999998316", List.of("999998778", "999998791"), "49"),
                Arguments.of("Lg01_004R", "999998353", List.of(), "2o"),
                Arguments.of("Lg01_005R", "999998341", List.of("999998778", "999998791"), "49"),
                Arguments.of("Lg01_006R", "999998328", List.of("999998778", "999998791"), "49"),
                Arguments.of("Lg01_007R", "999998365", List.of(""), "3a"),
                Arguments.of("Lg01_008R", "999998377", List.of(""), "38"),
                Arguments.of("Lg01_009R", "999998389", List.of(""), "3a"),
                Arguments.of("Lg01_010R", "999998390", List.of(), "2m"),
                Arguments.of("Lg01_011R", "999999266", List.of("999998390"), "40o2"),
                Arguments.of("Lg01_012R", "999999278", List.of("999998390"), "40o1"),
                Arguments.of("Lg01_013R", "999998420", List.of(""), "39e"),
                Arguments.of("Lg01_014R", "999998432", List.of(""), "39"),
                Arguments.of("Lg01_015R", "999998444", List.of(), "2m"),
                Arguments.of("Lg01_016R", "999998456", List.of("999998444"), "40o2"),
                Arguments.of("Lg01_017R", "999998468", List.of(), "2m"),
                Arguments.of("Lg01_018R", "999998481", List.of(""), "45e"),
                Arguments.of("Lg01_019R", "999998493", List.of(), "2m"),
                Arguments.of("Lg01_020R", "999998511", List.of(""), "1"),
                Arguments.of("Lg01_021R", "999998523", List.of(""), "45e"),
                Arguments.of("Lg01_022R", "999998535", List.of(""), "1"),
                Arguments.of("Lg01_023R", "999999175", List.of(""), "3"),
                Arguments.of("Lg01_024R", "999998547", List.of(), "2m"),
                Arguments.of("Lg01_025R", "999998559", List.of(), "2m"),
                Arguments.of("Lg01_026R", "999998572", List.of(""), "6"),
                Arguments.of("Lg01_027R", "999998560", List.of("999998547"), "51"),
                Arguments.of("Lg01_028R", "999998584", List.of(), "2m"),
                Arguments.of("Lg01_029R", "999998596", List.of(), "2m"),
                Arguments.of("Lg01_030R", "999998602", List.of("999998584"), "50"),
                Arguments.of("Lg01_031R", "999998614", List.of("999998584"), "50"),
                Arguments.of("Lg01_032R", "999998626", List.of(), "2m"),
                Arguments.of("Lg01_033R", "999998638", List.of(), "2m"),
                Arguments.of("Lg01_034R", "999998651", List.of("999998626", "999998638"), "7"),
                Arguments.of("Lg01_035R", "999998663", List.of("999998626", "999998638"), "45"),
                Arguments.of("Lg01_036R", "999998675", List.of(), "2m"),
                Arguments.of("Lg01_037R", "999998687", List.of(), "2m"),
                Arguments.of("Lg01_038R", "999998699", List.of("999998675"), "54o1"),
                Arguments.of("Lg01_039R", "999998705", List.of("999998675", "999998687"), "7"),
                Arguments.of("Lg01_040R", "999998717", List.of(""), "6"),
                Arguments.of("Lg01_041R", "999998729", List.of(), "2m"),
                Arguments.of("Lg01_042R", "999998742", List.of(), "2m"),
                Arguments.of("Lg01_043R", "999998808", List.of("999998742", "999998729"), "49"),
                Arguments.of("Lg01_044R", "999998754", List.of(""), "1"),
                Arguments.of("Lg01_045R", "999999242", List.of(""), "1"),
                Arguments.of("Lg01_046R", "999998766", List.of(), "2m"),
                Arguments.of("Lg01_047R", "999998821", List.of(), "2m"),
                Arguments.of("Lg01_048R", "999998833", List.of("999998821", "999998766"), "49"),
                Arguments.of("Lg01_049R", "999999245", List.of(""), "0"), // Bsn voldoet niet aan elfproef
                Arguments.of("Lg01_050R", "999998857", List.of(), "2m"),
                Arguments.of("Lg01_051R", "999998869", List.of("999998870", "999998882"), "27"),
                Arguments.of("Lg01_052R", "999998870", List.of(), "2m"),
                Arguments.of("Lg01_053R", "999998882", List.of(), "2m"),
                Arguments.of("Lg01_054R", "999998894", List.of("999998870", "999998882"), "49a"), // na impl 1.3a em 1.3b route 55a)
                Arguments.of("Lg01_055R", "999998900", List.of(), "2m"),
                Arguments.of("Lg01_056R", "999998912", List.of(), "2m"),
                Arguments.of("Lg01_057R", "999998961", List.of(""), "6"),
                Arguments.of("Lg01_058R", "999998948", List.of(""), "4ee"),
                Arguments.of("Lg01_059R", "999998936", List.of("999998912"), "11"),
                Arguments.of("Lg01_060R", "999998924", List.of("999998912", "999998900"), "27"),
                Arguments.of("Lg01_061R", "999998973", List.of(), "2m"),
                Arguments.of("Lg01_062R", "999998985", List.of("999998912"), "51"),
                Arguments.of("Lg01_063R", "999999011", List.of(), "2m"),
                Arguments.of("Lg01_064R", "999999023", List.of("999999011"), "11"),
                Arguments.of("Lg01_065R", "999999035", List.of(), "2m"),
                Arguments.of("Lg01_066R", "999999047", List.of(), "2m"),
                Arguments.of("Lg01_067R", "999999059", List.of("999999047", "999999035"), "55"),
                Arguments.of("Lg01_068R", "999999060", List.of("999999035", "999999047"), "7"),
                Arguments.of("Lg01_069R", "999999072", List.of(""), "54"),
                Arguments.of("Lg01_070R", "999999084", List.of(), "2m"),
                Arguments.of("Lg01_071R", "999999096", List.of(), "2m"),
                Arguments.of("Lg01_072R", "999999102", List.of("999999084"), "54o2"),
                Arguments.of("Lg01_073R", "999999114", List.of(), "2m"),
                Arguments.of("Lg01_074R", "999999126", List.of(), "2m"),
                Arguments.of("Lg01_075R", "999999138", List.of(), "2m"),
                Arguments.of("Lg01_076R", "999999151", List.of("999999126"), "54o1"),
                Arguments.of("Lg01_077R", "999999163", List.of(), "2m"),
                Arguments.of("Lg01_078R", "999999187", List.of(), "2m"),
                Arguments.of("Lg01_079R", "999999199", List.of(), "2m"),
                Arguments.of("Lg01_080R", "999999205", List.of("999999199"), "43o2"),
                Arguments.of("Lg01_081R", "999999217", List.of(), "2m"),
                Arguments.of("Lg01_082R", "999999229", List.of(), "2m"),
                Arguments.of("Lg01_083R", "999999230", List.of(""), "54"),
                Arguments.of("Lg01_084R", "999999448", List.of("999998870", "999998882"), "49"),
                Arguments.of("Lg01_085R", "999999461", List.of(), "2m"),
                Arguments.of("Lg01_086R", "999999473", List.of(""), "39"),
                Arguments.of("Lg01_087R", "999999485", List.of(), "2m"),
                Arguments.of("Lg01_088R", "999999497", List.of(), "2m"),
                Arguments.of("Lg01_089R", "999999503", List.of(""), "44"),
                Arguments.of("Lg01_090R", "999999515", List.of(""), "5"),
                Arguments.of("Lg01_091R", "999999527", List.of(), "2m"),
                Arguments.of("Lg01_092R", "999999539", List.of(), "2m"),
                Arguments.of("Lg01_093R", "999999540", List.of("999999527"), "42no2"),
                Arguments.of("Lg01_094R", "999999552", List.of(), "2m"),
                Arguments.of("Lg01_095R", "999999564", List.of(), "2m"),
                Arguments.of("Lg01_096R", "999999576", List.of(""), "52"),
                Arguments.of("Lg01_097R", "999999588", List.of(), "2m"),
                Arguments.of("Lg01_098R", "999999606", List.of(), "2m"),
                Arguments.of("Lg01_099R", "999999618", List.of(""), "5"),
                Arguments.of("Lg01_100R", "999999631", List.of(""), "37"),
                Arguments.of("Lg01_101R", "999999643", List.of(), "2m"),
                Arguments.of("Lg01_102R", "999999655", List.of(), "2m"),
                Arguments.of("Lg01_103R", "999999667", List.of(""), "52"),
                Arguments.of("Lg01_104R", "999999679", List.of(""), "14"),
                Arguments.of("Lg01_105R", "999999680", List.of(""), "6"),
                Arguments.of("Lg01_106R", "999999692", List.of(), "2m"),
                Arguments.of("Lg01_107R", "999999709", List.of(), "2m"),
                Arguments.of("Lg01_108R", "999999710", List.of(""), "52"),
                Arguments.of("Lg01_109R", "999999722", List.of(""), "6"),
                Arguments.of("Lg01_110R", "999999734", List.of("999998791"), "11"),
                Arguments.of("Lg01_111R", "999999746", List.of("999998778"), "13o2"),
                Arguments.of("Lg01_112R", "999999758", List.of(""), "5"),
                Arguments.of("Lg01_113R", "999999771", List.of(""), "5"),
                Arguments.of("Lg01_114R", "999999783", List.of(), "2m"),
                Arguments.of("Lg01_115R", "999999795", List.of(), "2m"),
                Arguments.of("Lg01_116R", "999999801", List.of("999999795", "999999783"), "41"),
                Arguments.of("Lg01_117R", "999999813", List.of("999999795", "999999783"), "41"),
                Arguments.of("Lg01_118R", "999999825", List.of("999999795", "999999783"), "49"),
                Arguments.of("Lg01_119R", "999999837", List.of(), "2m"),
                Arguments.of("Lg01_120R", "999999849", List.of(), "2m"),
                Arguments.of("Lg01_121R", "999999850", List.of("999999849","999999837"), "41"),
                Arguments.of("Lg01_122R", "999999862", List.of(), "2m"),
                Arguments.of("Lg01_123R", "999999874", List.of(), "2m"),
                Arguments.of("Lg01_124R", "999999886", List.of("999999862", "999999874"), "49"),
                Arguments.of("Lg01_125R", "999999898", List.of(), "2m"),
                Arguments.of("Lg01_126R", "999999904", List.of(), "2m"),
                Arguments.of("Lg01_127R", "999999916", List.of("999999904", "999999898"), "7"),
                Arguments.of("Lg01_128R", "999999928", List.of(""), "7e"),
                Arguments.of("Lg01_129R", "999999941", List.of("999999904","999999898"), "7"),
                Arguments.of("Lg01_130R", "999999953", List.of(), "2m"),
                Arguments.of("Lg01_131R", "999999965", List.of(), "2m"),
                Arguments.of("Lg01_132R", "999999977", List.of("999999953","999999965"), "49x"),
                Arguments.of("Lg01_133R", "999999989", List.of("999999965"), "40o2"),
                Arguments.of("Lg01_134R", "999970008", List.of(""), "2mi"),
                Arguments.of("Lg01_135R", "999970148", List.of(), "2m"),
                Arguments.of("Lg01_136R", "999970288", List.of(""), "49i"),
                Arguments.of("Lg01_137R", "999970331", List.of(""), "3ai"),
                Arguments.of("Lg01_138R", "999970422", List.of(), "2o"),
                Arguments.of("Lg01_139R", "999970434", List.of(""), "45e"),
                Arguments.of("Lg01_140R", "999970446", List.of(), "2m"),
                Arguments.of("Lg01_141R", "999970458", List.of(), "2m"),
                Arguments.of("Lg01_142R", "999970471", List.of("999970458", "999970446"), "54n"),
                Arguments.of("Lg01_143R", "999970483", List.of("999970458", "999970446"), "54n"),
                Arguments.of("Lg01_144R", "999970495", List.of("999970458", "999970446"), "54n"),
                Arguments.of("Lg01_145R", "999970501", List.of(), "2m"),
                Arguments.of("Lg01_146R", "999970513", List.of(), "2m"),
                Arguments.of("Lg01_147R", "999970525", List.of("999970513"), "13"),
                Arguments.of("Lg01_148R", "999970537", List.of("999970513", "999970501"), "54n"),
                Arguments.of("Lg01_149R", "999970549", List.of(""), "54"),
                Arguments.of("Lg01_150R", "999970550", List.of("999970513"), "13o2"),
                Arguments.of("Lg01_151R", "999970562", List.of("999970513", "999970501"), "54n"),
                Arguments.of("Lg01_152R", "999970574", List.of("999970513"), "54o2"),
                Arguments.of("Lg01_153R", "999970586", List.of(), "2m"),
                Arguments.of("Lg01_154R", "999970598", List.of(), "2m"),
                Arguments.of("Lg01_155R", "999970604", List.of("999970598", "999970586"), "49"),
                Arguments.of("Lg01_156R", "999970616", List.of(), "2m"),
                Arguments.of("Lg01_157R", "999970628", List.of(), "2m"),
                Arguments.of("Lg01_158R", "999970641", List.of("999970616", "999970653"), "54n"),
                Arguments.of("Lg01_159R", "999970653", List.of(), "2m"),
                Arguments.of("Lg01_160R", "999970665", List.of("999970616", "999970653"), "54n"),
                Arguments.of("Lg01_161R", "999970677", List.of(), "2m"),
                Arguments.of("Lg01_162R", "999970689", List.of(), "2m"),
                Arguments.of("Lg01_163R", "999970690", List.of(), "2m"),
                Arguments.of("Lg01_164R", "999970707", List.of(""), "5"),
                Arguments.of("Lg01_165R", "999970719", List.of(""), "5"),
                Arguments.of("Lg01_166R", "999970021", List.of("999999126","999999163"), "41"),
                Arguments.of("Lg01_167R", "999970033", List.of(""), "54"),
                Arguments.of("Lg01_168R", "999970045", List.of("999999126", "999999163"), "7"),
                Arguments.of("Lg01_169R", "999970057", List.of(), "2m"),
                Arguments.of("Lg01_170R", "999970069", List.of(), "2m"),
                Arguments.of("Lg01_171R", "999970070", List.of("999970057", "999970069"), "33"),
                Arguments.of("Lg01_172R", "999970082", List.of("999970057"), "18o2"),
                Arguments.of("Lg01_173R", "999970094", List.of(""), "39e"),
                Arguments.of("Lg01_174R", "999970100", List.of(""), "39"),
                Arguments.of("Lg01_175R", "999970112", List.of(""), "5"),
                Arguments.of("Lg01_176R", "999970124", List.of(), "2m"),
                Arguments.of("Lg01_177R", "999970136", List.of(), "2m"),
                Arguments.of("Lg01_178R", "999970161", List.of("999970124", "999970136"), "41"),
                Arguments.of("Lg01_179R", "999970173", List.of(""), "5"),
                Arguments.of("Lg01_180R", "999970185", List.of("999970124"), "40o2"),
                Arguments.of("Lg01_181R", "999970197", List.of(), "2m"),
                Arguments.of("Lg01_182R", "999970203", List.of(), "2m"),
                Arguments.of("Lg01_183R", "999970215", List.of("999970203"), "43o2"),
                Arguments.of("Lg01_184R", "999970227", List.of(""), "14"),
                Arguments.of("Lg01_185R", "999970239", List.of(), "2m"),
                Arguments.of("Lg01_186R", "999970240", List.of(), "2m"),
                Arguments.of("Lg01_187R", "999970252", List.of("999970240"), "43o2"),
                Arguments.of("Lg01_188R", "999970318", List.of(), "2m"),
                Arguments.of("Lg01_189R", "999970264", List.of(""), "40o2i"),
                Arguments.of("Lg01_190R", "999970276", List.of("999970318"), "40o2"),
                Arguments.of("Lg01_191R", "999970306", List.of(""), "40o2i"),
                Arguments.of("Lg01_192R", "999970343", List.of("999970318"), "40o2"),
                Arguments.of("Lg01_193R", "999970355", List.of("999998870","999998882"), "49a"),
                Arguments.of("Lg01_194R", "999970367", List.of("999998870", "999998882"), "49a"),
                Arguments.of("Lg01_195R", "999970379", List.of("999998870", "999998882"), "49a"),
                Arguments.of("Lg01_196R", "999970380", List.of("999998870","999998882"),"49a"),
                Arguments.of("Lg01_197R", "999970392", List.of(""), "45e"),
                Arguments.of("Lg01_198R", "999970409", List.of("999970124", "999970410"), "54n"),
                Arguments.of("Lg01_199R", "999970410", List.of(), "2m"),
                Arguments.of("Lg01_200R", "999970720", List.of(), "2m"),
                Arguments.of("Lg01_201R", "999970732", List.of(), "2m"),
                Arguments.of("Lg01_202R", "999970744", List.of("999970732"), "40o2"),
                Arguments.of("Lg01_203R", "999970756", List.of(), "2m"),
                Arguments.of("Lg01_204R", "999970768", List.of(), "2m"),
                Arguments.of("Lg01_205R", "999970781", List.of("999970768"), "9"),
                Arguments.of("Lg01_206R", "999970793", List.of("999970768"), "53n2"),
                Arguments.of("Lg01_207R", "999970963", List.of("999998912"), "40o2"),
                Arguments.of("Lg01_208R", "999970975", List.of("999998912"), "40o1"),
                Arguments.of("Lg01_209R", "999970987", List.of(), "2m"),
                Arguments.of("Lg01_210R", "999970999", List.of(), "2m"),
                Arguments.of("Lg01_211R", "999971001", List.of("999970987"), "42no2"),
                Arguments.of("Lg01_212R", "999971013", List.of("999970987"), "42no1"),
                Arguments.of("Lg01_213R", "999971025", List.of("999970987"), "43o2"),
                Arguments.of("Lg01_214R", "999971001", List.of("999970987"), "42no2"),
                Arguments.of("Lg01_215R", "999971049", List.of(""), "54")
        );
    }

    @ParameterizedTest
    @MethodSource("testArguments")
    void executeRouteTest(String testCase, String bsnKind, List<String> bsnsGezaghoudersExpected,
                          String expectedRoute) throws AfleidingsregelException  {
        super.executeRouteTest(new RouteTestParameters(testCase, bsnKind, bsnsGezaghoudersExpected,
                expectedRoute));
    }

}
