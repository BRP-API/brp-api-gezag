package nl.rijksoverheid.mev.privateapi.gezagsmodule;

import nl.rijksoverheid.mev.exception.AfleidingsregelException;
import nl.rijksoverheid.mev.privateapi.gezagsmodule.util.CsvTestResultWriter;
import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.Arguments;
import org.junit.jupiter.params.provider.MethodSource;
import org.springframework.test.context.TestPropertySource;

import java.io.IOException;
import java.util.List;
import java.util.stream.Stream;

@TestPropertySource(properties = {"app.features.brp.dataset-path=src/test/resources/fixtures/persoonslijsten/GegenereerdUitExcelData/CGR_testbestand-20220825_onder_pilot_autorisatiebesluit", "app.clock=2023-02-01T00:00:00Z"})
public class GezagsmoduleCgrTest extends GezagsmoduleTest {

    @BeforeAll
    public static void setup() throws IOException {
        CsvTestResultWriter.setup("CgrTestOutput.csv");
    }

    private static Stream<Arguments> testArguments() {
        return Stream.of(
                Arguments.of("Lg01_001", "999998778", List.of(), "2m"),
                Arguments.of("Lg01_002", "999998791", List.of(), "2m"),
                Arguments.of("Lg01_003", "999998316", List.of("999998778", "999998791"), "49"),
                Arguments.of("Lg01_004", "999998353", List.of(), "2o"),
                Arguments.of("Lg01_005", "999998341", List.of("999998778", "999998791"), "49"),
                Arguments.of("Lg01_006", "999998328", List.of("999998778", "999998791"), "49"),
                Arguments.of("Lg01_007", "999998365", List.of(""), "3a"),
                Arguments.of("Lg01_008", "999998377", List.of(""), "38"),
                Arguments.of("Lg01_009", "999998389", List.of(""), "3a"),
                Arguments.of("Lg01_010", "999998390", List.of(), "2m"),
                Arguments.of("Lg01_011", "999999266", List.of("999998390"), "40o1"),
                Arguments.of("Lg01_012", "999999278", List.of("999998390"), "40o2"),
                Arguments.of("Lg01_013", "999998420", List.of(""), "39e"),
                Arguments.of("Lg01_014", "999998432", List.of(""), "39"),
                Arguments.of("Lg01_015", "999998444", List.of(), "2m"),
                Arguments.of("Lg01_016", "999998456", List.of("999998444"), "40o1"),
                Arguments.of("Lg01_017", "999998468", List.of(), "2m"),
                Arguments.of("Lg01_018", "999998481", List.of(""), "45e"),
                Arguments.of("Lg01_019", "999998493", List.of(), "2m"),
                Arguments.of("Lg01_020", "999998511", List.of(""), "1"),
                Arguments.of("Lg01_021", "999998523", List.of(""), "45e"),
                Arguments.of("Lg01_022", "999998535", List.of(""), "1"),
                Arguments.of("Lg01_023", "999999175", List.of(""), "3"),
                Arguments.of("Lg01_024", "999998547", List.of(), "2m"),
                Arguments.of("Lg01_025", "999998559", List.of(), "2m"),
                Arguments.of("Lg01_026", "999998572", List.of(""), "6"),
                Arguments.of("Lg01_027", "999998560", List.of("999998547"), "50"),
                Arguments.of("Lg01_028", "999998584", List.of(), "2m"),
                Arguments.of("Lg01_029", "999998596", List.of(), "2m"),
                Arguments.of("Lg01_030", "999998602", List.of("999998584"), "51"),
                Arguments.of("Lg01_031", "999998614", List.of("999998584"), "51"),
                Arguments.of("Lg01_032", "999998626", List.of(), "2m"),
                Arguments.of("Lg01_033", "999998638", List.of(), "2m"),
                Arguments.of("Lg01_034", "999998651", List.of("999998626", "999998638"), "7"),
                Arguments.of("Lg01_035", "999998663", List.of("999998626", "999998638"), "45"),
                Arguments.of("Lg01_036", "999998675", List.of(), "2m"),
                Arguments.of("Lg01_037", "999998687", List.of(), "2m"),
                Arguments.of("Lg01_038", "999998699", List.of("999998675"), "54o2"),
                Arguments.of("Lg01_039", "999998705", List.of("999998675", "999998687"), "7"),
                Arguments.of("Lg01_040", "999998717", List.of(""), "6"),
                Arguments.of("Lg01_041", "999998729", List.of(), "2m"),
                Arguments.of("Lg01_042", "999998742", List.of(), "2m"),
                Arguments.of("Lg01_043", "999998808", List.of("999998742", "999998729"), "49"),
                Arguments.of("Lg01_044", "999998754", List.of(""), "1"),
                Arguments.of("Lg01_045", "999999242", List.of(""), "1"),
                Arguments.of("Lg01_046", "999998766", List.of(), "2m"),
                Arguments.of("Lg01_047", "999998821", List.of(), "2m"),
                Arguments.of("Lg01_048", "999998833", List.of("999998821", "999998766"), "49"),
                Arguments.of("Lg01_049", "999999245", List.of(""), "0"), // Bsn voldoet niet aan elfproef
                Arguments.of("Lg01_050", "999998857", List.of(), "2m"),
                Arguments.of("Lg01_051", "999998869", List.of("999998870", "999998882"), "27"),
                Arguments.of("Lg01_052", "999998870", List.of(), "2m"),
                Arguments.of("Lg01_053", "999998882", List.of(), "2m"),
                Arguments.of("Lg01_054", "999998894", List.of("999998870", "999998882"), "49a"), // na impl 1.3a em 1.3b route 55a)
                Arguments.of("Lg01_055", "999998900", List.of(), "2m"),
                Arguments.of("Lg01_056", "999998912", List.of(), "2m"),
                Arguments.of("Lg01_057", "999998961", List.of(""), "6"),
                Arguments.of("Lg01_058", "999998948", List.of(""), "4ee"),
                Arguments.of("Lg01_059", "999998936", List.of("999998912"), "13"),
                Arguments.of("Lg01_060", "999998924", List.of("999998912", "999998900"), "27"),
                Arguments.of("Lg01_061", "999998973", List.of(), "2m"),
                Arguments.of("Lg01_062", "999998985", List.of("999998912"), "50"),
                Arguments.of("Lg01_063", "999999011", List.of(), "2m"),
                Arguments.of("Lg01_064", "999999023", List.of("999999011"), "13"),
                Arguments.of("Lg01_065", "999999035", List.of(), "2m"),
                Arguments.of("Lg01_066", "999999047", List.of(), "2m"),
                Arguments.of("Lg01_067", "999999059", List.of("999999047", "999999035"), "55"),
                Arguments.of("Lg01_068", "999999060", List.of("999999035", "999999047"), "7"),
                Arguments.of("Lg01_069", "999999072", List.of(""), "54"),
                Arguments.of("Lg01_070", "999999084", List.of(), "2m"),
                Arguments.of("Lg01_071", "999999096", List.of(), "2m"),
                Arguments.of("Lg01_072", "999999102", List.of("999999084"), "54o1"),
                Arguments.of("Lg01_073", "999999114", List.of(), "2m"),
                Arguments.of("Lg01_074", "999999126", List.of(), "2m"),
                Arguments.of("Lg01_075", "999999138", List.of(), "2m"),
                Arguments.of("Lg01_076", "999999151", List.of("999999126"), "54o2"),
                Arguments.of("Lg01_077", "999999163", List.of(), "2m"),
                Arguments.of("Lg01_078", "999999187", List.of(), "2m"),
                Arguments.of("Lg01_079", "999999199", List.of(), "2m"),
                Arguments.of("Lg01_080", "999999205", List.of("999999199"), "43o1"),
                Arguments.of("Lg01_081", "999999217", List.of(), "2m"),
                Arguments.of("Lg01_082", "999999229", List.of(), "2m"),
                Arguments.of("Lg01_083", "999999230", List.of(""), "54"),
                Arguments.of("Lg01_084", "999999448", List.of("999998870", "999998882"), "49"),
                Arguments.of("Lg01_085", "999999461", List.of(), "2m"),
                Arguments.of("Lg01_086", "999999473", List.of(""), "39"),
                Arguments.of("Lg01_087", "999999485", List.of(), "2m"),
                Arguments.of("Lg01_088", "999999497", List.of(), "2m"),
                Arguments.of("Lg01_089", "999999503", List.of(""), "44"),
                Arguments.of("Lg01_090", "999999515", List.of(""), "4"),
                Arguments.of("Lg01_091", "999999527", List.of(), "2m"),
                Arguments.of("Lg01_092", "999999539", List.of(), "2m"),
                Arguments.of("Lg01_093", "999999540", List.of("999999527"), "42no1"),
                Arguments.of("Lg01_094", "999999552", List.of(), "2m"),
                Arguments.of("Lg01_095", "999999564", List.of(), "2m"),
                Arguments.of("Lg01_096", "999999576", List.of(""), "52"),
                Arguments.of("Lg01_097", "999999588", List.of(), "2m"),
                Arguments.of("Lg01_098", "999999606", List.of(), "2m"),
                Arguments.of("Lg01_099", "999999618", List.of(""), "4"),
                Arguments.of("Lg01_100", "999999631", List.of(""), "37"),
                Arguments.of("Lg01_101", "999999643", List.of(), "2m"),
                Arguments.of("Lg01_102", "999999655", List.of(), "2m"),
                Arguments.of("Lg01_103", "999999667", List.of(""), "52"),
                Arguments.of("Lg01_104", "999999679", List.of(""), "12"),
                Arguments.of("Lg01_105", "999999680", List.of(""), "6"),
                Arguments.of("Lg01_106", "999999692", List.of(), "2m"),
                Arguments.of("Lg01_107", "999999709", List.of(), "2m"),
                Arguments.of("Lg01_108", "999999710", List.of(""), "52"),
                Arguments.of("Lg01_109", "999999722", List.of(""), "6"),
                Arguments.of("Lg01_110", "999999734", List.of("999998791"), "13"),
                Arguments.of("Lg01_111", "999999746", List.of("999998778"), "11o1"),
                Arguments.of("Lg01_112", "999999758", List.of(""), "4"),
                Arguments.of("Lg01_113", "999999771", List.of(""), "4"),
                Arguments.of("Lg01_114", "999999783", List.of(), "2m"),
                Arguments.of("Lg01_115", "999999795", List.of(), "2m"),
                Arguments.of("Lg01_116", "999999801", List.of("999999795", "999999783"), "41"),
                Arguments.of("Lg01_117", "999999813", List.of("999999795", "999999783"), "41"),
                Arguments.of("Lg01_118", "999999825", List.of("999999795", "999999783"), "49"),
                Arguments.of("Lg01_119", "999999837", List.of(), "2m"),
                Arguments.of("Lg01_120", "999999849", List.of(), "2m"),
                Arguments.of("Lg01_121", "999999850", List.of("999999849","999999837"), "41"),
                Arguments.of("Lg01_122", "999999862", List.of(), "2m"),
                Arguments.of("Lg01_123", "999999874", List.of(), "2m"),
                Arguments.of("Lg01_124", "999999886", List.of("999999862", "999999874"), "49"),
                Arguments.of("Lg01_125", "999999898", List.of(), "2m"),
                Arguments.of("Lg01_126", "999999904", List.of(), "2m"),
                Arguments.of("Lg01_127", "999999916", List.of("999999904", "999999898"), "7"),
                Arguments.of("Lg01_128", "999999928", List.of(""), "7e"),
                Arguments.of("Lg01_129", "999999941", List.of("999999904","999999898"), "7"),
                Arguments.of("Lg01_130", "999999953", List.of(), "2m"),
                Arguments.of("Lg01_131", "999999965", List.of(), "2m"),
                Arguments.of("Lg01_132", "999999977", List.of("999999953","999999965"), "49x"),
                Arguments.of("Lg01_133", "999999989", List.of("999999965"), "40o1"),
                Arguments.of("Lg01_134", "999970008", List.of(""), "2mi"),
                Arguments.of("Lg01_135", "999970148", List.of(), "2m"),
                Arguments.of("Lg01_136", "999970288", List.of(""), "49i"),
                Arguments.of("Lg01_137", "999970331", List.of(""), "3ai"),
                Arguments.of("Lg01_138", "999970422", List.of(), "2o"),
                Arguments.of("Lg01_139", "999970434", List.of(""), "45e"),
                Arguments.of("Lg01_140", "999970446", List.of(), "2m"),
                Arguments.of("Lg01_141", "999970458", List.of(), "2m"),
                Arguments.of("Lg01_142", "999970471", List.of("999970458", "999970446"), "54n"),
                Arguments.of("Lg01_143", "999970483", List.of("999970458", "999970446"), "54n"),
                Arguments.of("Lg01_144", "999970495", List.of("999970458", "999970446"), "54n"),
                Arguments.of("Lg01_145", "999970501", List.of(), "2m"),
                Arguments.of("Lg01_146", "999970513", List.of(), "2m"),
                Arguments.of("Lg01_147", "999970525", List.of("999970513"), "11"),
                Arguments.of("Lg01_148", "999970537", List.of("999970513", "999970501"), "54n"),
                Arguments.of("Lg01_149", "999970549", List.of(""), "54"),
                Arguments.of("Lg01_150", "999970550", List.of("999970513"), "11o1"),
                Arguments.of("Lg01_151", "999970562", List.of("999970513", "999970501"), "54n"),
                Arguments.of("Lg01_152", "999970574", List.of("999970513"), "54o1"),
                Arguments.of("Lg01_153", "999970586", List.of(), "2m"),
                Arguments.of("Lg01_154", "999970598", List.of(), "2m"),
                Arguments.of("Lg01_155", "999970604", List.of("999970598", "999970586"), "49"),
                Arguments.of("Lg01_156", "999970616", List.of(), "2m"),
                Arguments.of("Lg01_157", "999970628", List.of(), "2m"),
                Arguments.of("Lg01_158", "999970641", List.of("999970616", "999970653"), "54n"),
                Arguments.of("Lg01_159", "999970653", List.of(), "2m"),
                Arguments.of("Lg01_160", "999970665", List.of("999970616", "999970653"), "54n"),
                Arguments.of("Lg01_161", "999970677", List.of(), "2m"),
                Arguments.of("Lg01_162", "999970689", List.of(), "2m"),
                Arguments.of("Lg01_163", "999970690", List.of(), "2m"),
                Arguments.of("Lg01_164", "999970707", List.of(""), "4"),
                Arguments.of("Lg01_165", "999970719", List.of(""), "4"),
                Arguments.of("Lg01_166", "999970021", List.of("999999126", "999999163"), "41"),
                Arguments.of("Lg01_167", "999970033", List.of(""), "54"),
                Arguments.of("Lg01_168", "999970045", List.of("999999126", "999999163"), "7"),
                Arguments.of("Lg01_169", "999970057", List.of(), "2m"),
                Arguments.of("Lg01_170", "999970069", List.of(), "2m"),
                Arguments.of("Lg01_171", "999970070", List.of("999970057", "999970069"), "33"),
                Arguments.of("Lg01_172", "999970082", List.of("999970057"), "18o1"),
                Arguments.of("Lg01_173", "999970094", List.of(""), "39e"),
                Arguments.of("Lg01_174", "999970100", List.of(""), "39"),
                Arguments.of("Lg01_175", "999970112", List.of(""), "4"),
                Arguments.of("Lg01_176", "999970124", List.of(), "2m"),
                Arguments.of("Lg01_177", "999970136", List.of(), "2m"),
                Arguments.of("Lg01_178", "999970161", List.of("999970124", "999970136"), "41"),
                Arguments.of("Lg01_179", "999970173", List.of(""), "4"),
                Arguments.of("Lg01_180", "999970185", List.of("999970124"), "40o1"),
                Arguments.of("Lg01_181", "999970197", List.of(), "2m"),
                Arguments.of("Lg01_182", "999970203", List.of(), "2m"),
                Arguments.of("Lg01_183", "999970215", List.of("999970203"), "43o1"),
                Arguments.of("Lg01_184", "999970227", List.of(""), "12"),
                Arguments.of("Lg01_185", "999970239", List.of(), "2m"),
                Arguments.of("Lg01_186", "999970240", List.of(), "2m"),
                Arguments.of("Lg01_187", "999970252", List.of("999970240"), "43o1"),
                Arguments.of("Lg01_188", "999970318", List.of(), "2m"),
                Arguments.of("Lg01_189", "999970264", List.of(""), "40o1i"),
                Arguments.of("Lg01_190", "999970276", List.of("999970318"), "40o1"),
                Arguments.of("Lg01_191", "999970306", List.of(""), "40o1i"),
                Arguments.of("Lg01_192", "999970343", List.of("999970318"), "40o1"),
                Arguments.of("Lg01_193", "999970355", List.of("999998870","999998882"), "49a"),
                Arguments.of("Lg01_194", "999970367", List.of("999998870","999998882"), "49a"),
                Arguments.of("Lg01_195", "999970379", List.of("999998870", "999998882"), "49a"),
                Arguments.of("Lg01_196", "999970380", List.of("999998870","999998882"),"49a"),
                Arguments.of("Lg01_197", "999970392", List.of(""), "45e"),
                Arguments.of("Lg01_198", "999970409", List.of("999970124", "999970410"), "54n"),
                Arguments.of("Lg01_199", "999970410", List.of(), "2m"),
                Arguments.of("Lg01_200", "999970720", List.of(), "2m"),
                Arguments.of("Lg01_201", "999970732", List.of(), "2m"),
                Arguments.of("Lg01_202", "999970744", List.of("999970732"), "40o1"),
                Arguments.of("Lg01_203", "999970756", List.of(), "2m"),
                Arguments.of("Lg01_204", "999970768", List.of(), "2m"),
                Arguments.of("Lg01_205", "999970781", List.of("999970768"), "8"),
                Arguments.of("Lg01_206", "999970793", List.of("999970768"), "53n1"),
                Arguments.of("Lg01_207", "999970963", List.of("999998912"), "40o1"),
                Arguments.of("Lg01_208", "999970975", List.of("999998912"), "40o2"),
                Arguments.of("Lg01_209", "999970987", List.of(), "2m"),
                Arguments.of("Lg01_210", "999970999", List.of(), "2m"),
                Arguments.of("Lg01_211", "999971001", List.of("999970987"), "42no1"),
                Arguments.of("Lg01_212", "999971013", List.of("999970987"), "42no2"),
                Arguments.of("Lg01_213", "999971025", List.of("999970987"), "43o1"),
                Arguments.of("Lg01_214", "999971001", List.of("999970987"), "42no1"),
                Arguments.of("Lg01_215", "999971049", List.of(""), "54")

        );
    }

    @ParameterizedTest
    @MethodSource("testArguments")
    void executeRouteTest(String testCase, String bsnKind, List<String> bsnsGezaghoudersExpected,
                          String expectedRoute) throws AfleidingsregelException  {
        super.executeRouteTest(new RouteTestParameters(testCase, bsnKind, bsnsGezaghoudersExpected,
                expectedRoute));
    }
}
